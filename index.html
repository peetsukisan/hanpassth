<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website - โปรโมชั่นและขั้นตอนการใช้งาน</title>
    <meta name="description" content="ค้นพบโปรโมชั่นพิเศษและขั้นตอนการใช้งานง่ายๆ">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <a href="#" class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="20" cy="20" r="18" stroke="#2B4ACF" stroke-width="3" />
                        <path d="M12 20C12 15.5817 15.5817 12 20 12C24.4183 12 28 15.5817 28 20" stroke="#2B4ACF"
                            stroke-width="3" stroke-linecap="round" />
                        <circle cx="20" cy="20" r="4" fill="#2B4ACF" />
                    </svg>
                </div>
                <span class="logo-text" id="brand-name-display">MyBrand</span>
            </a>
            <nav class="nav-menu">
                <a href="#promotions" class="nav-link">โปรโมชั่น</a>
                <a href="#how-to-use" class="nav-link">ขั้นตอนการใช้งาน</a>
                <a href="#faq" class="nav-link">ปัญหาที่พบบ่อย</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section with Search -->
    <section class="hero-section">
        <div class="search-box">
            <div class="search-container">
                <input type="text" class="search-input"
                    placeholder="ค้นหาโปรโมชั่น, ขั้นตอนการใช้งาน หรือ ปัญหาการใช้งาน">
                <button class="search-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.3-4.3"></path>
                    </svg>
                </button>
            </div>
        </div>
    </section>

    <!-- Promotions Carousel -->
    <section id="promotions" class="carousel-section">
        <div class="carousel-container">
            <div class="carousel-wrapper">
                <div class="carousel-track" id="promo-carousel">
                    <div class="loading-placeholder">
                        <div class="loading-spinner"></div>
                        <p>กำลังโหลดโปรโมชั่น...</p>
                    </div>
                </div>
            </div>

            <!-- Carousel Controls (emart24 style) -->
            <div class="carousel-controls-emart">
                <button class="control-btn pause-btn" id="pause-btn" aria-label="Pause">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                        fill="currentColor" id="pause-icon">
                        <rect x="6" y="4" width="4" height="16"></rect>
                        <rect x="14" y="4" width="4" height="16"></rect>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                        fill="currentColor" id="play-icon" style="display:none;">
                        <polygon points="5,3 19,12 5,21"></polygon>
                    </svg>
                </button>
                <button class="control-btn arrow-btn" id="prev-btn" aria-label="Previous">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5">
                        <path d="m15 18-6-6 6-6" />
                    </svg>
                </button>
                <button class="control-btn arrow-btn" id="next-btn" aria-label="Next">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5">
                        <path d="m9 18 6-6-6-6" />
                    </svg>
                </button>
                <span class="page-num current" id="page-current">1</span>
                <div class="progress-track">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <span class="page-num total" id="page-total">1</span>
            </div>
        </div>
    </section>

    <!-- How to Use Section -->
    <section id="how-to-use" class="how-to-section">
        <div class="section-container">
            <h2 class="section-title" id="guides-title">ขั้นตอนการใช้งาน</h2>
            <p class="section-subtitle">เริ่มต้นใช้งานง่ายๆ</p>
            <div class="steps-grid" id="steps-grid">
                <div class="loading-placeholder">
                    <div class="loading-spinner"></div>
                    <p>กำลังโหลด...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="faq-section">
        <div class="section-container">
            <h2 class="section-title" id="faqs-title">ปัญหาที่พบบ่อย</h2>
            <p class="section-subtitle">คำถามและคำตอบสำหรับปัญหาที่พบบ่อย</p>
            <div class="faq-grid" id="faq-grid">
                <div class="loading-placeholder">
                    <div class="loading-spinner"></div>
                    <p>กำลังโหลด...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <p>&copy; 2024 MyBrand. All rights reserved.</p>
        </div>
    </footer>

    <!-- Popup Ad Container (wooricard style) -->
    <div class="popup-overlay" id="popup-ad" style="display: none;">
        <div class="popup-content popup-wide">
            <div class="popup-header">
                <h3 class="popup-title" id="popup-title-text">โปรโมชั่นพิเศษ</h3>
                <button class="popup-close" onclick="closePopup()">&times;</button>
            </div>
            <div class="popup-main">
                <button class="popup-arrow popup-arrow-left" onclick="prevPopup()" id="popup-arrow-left">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M15 18l-6-6 6-6" />
                    </svg>
                </button>
                <div class="popup-carousel" id="popup-carousel">
                    <!-- Popups will be loaded dynamically -->
                </div>
                <button class="popup-arrow popup-arrow-right" onclick="nextPopup()" id="popup-arrow-right">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M9 18l6-6-6-6" />
                    </svg>
                </button>
            </div>
            <div class="popup-dots" id="popup-dots">
                <!-- Dots will be generated dynamically -->
            </div>
            <div class="popup-footer">
                <label class="popup-checkbox-label">
                    <input type="checkbox" id="popup-dont-show">
                    <span>3วันไม่ต้องแสดงอีก</span>
                </label>
                <button class="popup-close-btn" onclick="closePopupWithCheck()">ปิด</button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation Bar (Mobile) -->
    <nav class="bottom-nav" id="bottom-nav">
        <a href="#" class="bottom-nav-item active" data-target="top">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                <polyline points="9,22 9,12 15,12 15,22" />
            </svg>
            <span>หน้าหลัก</span>
        </a>
        <a href="#promotions" class="bottom-nav-item" data-target="promotions">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <path d="M12 2v4" />
                <path d="m16.24 7.76-2.12 2.12" />
                <path d="M20 12h-4" />
                <path d="m16.24 16.24-2.12-2.12" />
                <path d="M12 20v-4" />
                <path d="m7.76 16.24 2.12-2.12" />
                <path d="M4 12h4" />
                <path d="m7.76 7.76 2.12 2.12" />
            </svg>
            <span>โปรโมชั่น</span>
        </a>
        <a href="#how-to-use" class="bottom-nav-item" data-target="how-to-use">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
                <polyline points="14,2 14,8 20,8" />
                <line x1="16" y1="13" x2="8" y2="13" />
                <line x1="16" y1="17" x2="8" y2="17" />
            </svg>
            <span>ขั้นตอน</span>
        </a>
        <a href="#faq" class="bottom-nav-item" data-target="faq">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10" />
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                <path d="M12 17h.01" />
            </svg>
            <span>ปัญหา</span>
        </a>
    </nav>

    <!-- Messenger Button -->
    <a href="https://m.me/182272919008772" target="_blank" class="messenger-btn" title="แชทกับเรา">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="white">
            <path
                d="M12 2C6.48 2 2 6.21 2 11.26c0 2.91 1.44 5.51 3.69 7.21V22l3.37-1.85c.9.25 1.87.39 2.94.39 5.52 0 10-4.21 10-9.26S17.52 2 12 2zm1.1 12.47l-2.54-2.71-4.96 2.71 5.45-5.79 2.6 2.71 4.9-2.71-5.45 5.79z" />
        </svg>
    </a>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="db-service.js"></script>
    <script src="script.js"></script>

    <!-- Popup Script -->
    <script>
        let popupData = [];
        let currentPopupIndex = 0;

        async function loadPopupAds() {
            try {
                popupData = await dbService.getPopups(true);
                if (popupData.length > 0) {
                    checkShowPopup();
                }
            } catch (error) {
                console.error('Error loading popups:', error);
            }
        }

        function renderPopups() {
            const carousel = document.getElementById('popup-carousel');
            const dotsContainer = document.getElementById('popup-dots');
            const arrows = document.querySelectorAll('.popup-arrow');

            if (popupData.length === 0) return;

            // Set first popup title
            document.getElementById('popup-title-text').textContent = popupData[0].title || 'โปรโมชั่นพิเศษ';

            carousel.innerHTML = popupData.map((popup, i) => {
                if (popup.type === 'image' && popup.image) {
                    return `<div class="popup-slide ${i === 0 ? 'active' : ''}" data-index="${i}">
                        ${popup.link ? `<a href="${popup.link}" target="_blank">` : ''}
                        <img src="${popup.image}" alt="${popup.title || 'Popup'}" class="popup-image">
                        ${popup.link ? '</a>' : ''}
                    </div>`;
                } else {
                    return `<div class="popup-slide ${i === 0 ? 'active' : ''}" data-index="${i}">
                        <div class="popup-body">
                            <h3>${popup.heading || 'โปรโมชั่นพิเศษ!'}</h3>
                            <p>${popup.message || ''}</p>
                            ${popup.link ? `<a href="${popup.link}" class="popup-btn" target="_blank">${popup.buttonText || 'ดูเพิ่มเติม'}</a>` : ''}
                        </div>
                    </div>`;
                }
            }).join('');

            // Create dots
            dotsContainer.innerHTML = popupData.map((_, i) =>
                `<button class="popup-dot ${i === 0 ? 'active' : ''}" onclick="goToPopup(${i})"></button>`
            ).join('');

            // Show/hide arrows and dots based on count
            arrows.forEach(a => a.style.display = popupData.length > 1 ? 'flex' : 'none');
            dotsContainer.style.display = popupData.length > 1 ? 'flex' : 'none';
        }

        function updatePopupIndicator() {
            // Update title
            if (popupData[currentPopupIndex]) {
                document.getElementById('popup-title-text').textContent = popupData[currentPopupIndex].title || 'โปรโมชั่นพิเศษ';
            }
            // Update slides
            document.querySelectorAll('.popup-slide').forEach((slide, i) => {
                slide.classList.toggle('active', i === currentPopupIndex);
            });
            // Update dots
            document.querySelectorAll('.popup-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === currentPopupIndex);
            });
        }

        function goToPopup(index) {
            currentPopupIndex = index;
            updatePopupIndicator();
        }

        function nextPopup() {
            currentPopupIndex = (currentPopupIndex + 1) % popupData.length;
            updatePopupIndicator();
        }

        function prevPopup() {
            currentPopupIndex = (currentPopupIndex - 1 + popupData.length) % popupData.length;
            updatePopupIndicator();
        }

        function checkShowPopup() {
            const hideUntil = localStorage.getItem('popupHideUntil');
            const now = new Date().getTime();
            if ((!hideUntil || now > parseInt(hideUntil)) && popupData.length > 0) {
                renderPopups();
                document.getElementById('popup-ad').style.display = 'flex';
            }
        }

        function closePopup() {
            document.getElementById('popup-ad').style.display = 'none';
        }

        function closePopupWithCheck() {
            if (document.getElementById('popup-dont-show').checked) {
                // Hide for 3 days
                const hideUntil = new Date().getTime() + (3 * 24 * 60 * 60 * 1000);
                localStorage.setItem('popupHideUntil', hideUntil);
            }
            closePopup();
        }

        // Load popups on page load
        window.addEventListener('load', loadPopupAds);
    </script>
</body>

</html>